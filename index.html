<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Collaboration with WebRTC</title>
</head>
<body>
    <h2>Real-Time Collaboration Example</h2>
    <textarea id="editor" rows="10" cols="50"></textarea>
    <script>
        let localConnection;
        let remoteConnection;
        let sendChannel;
        let receiveChannel;

        // Create local and remote connections
        localConnection = new RTCPeerConnection();
        remoteConnection = new RTCPeerConnection();

        // Create a data channel on the local peer
        sendChannel = localConnection.createDataChannel("sendDataChannel");

        // Setup receive channel on remote peer
        remoteConnection.ondatachannel = function(event) {
            receiveChannel = event.channel;
            receiveChannel.onmessage = (e) => {
                document.getElementById('editor').value = e.data;
            };
        };

        // When text changes, send it to the other peer
        document.getElementById('editor').addEventListener('input', () => {
            sendChannel.send(document.getElementById('editor').value);
        });

        // Create an offer and set it to establish the connection
        localConnection.createOffer().then(offer => {
            localConnection.setLocalDescription(offer);
            remoteConnection.setRemoteDescription(offer);
            return remoteConnection.createAnswer();
        }).then(answer => {
            remoteConnection.setLocalDescription(answer);
            localConnection.setRemoteDescription(answer);
        }).catch(err => console.log(err));
    </script>
</body>
</html>
